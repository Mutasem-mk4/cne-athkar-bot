name: Bot Reminders Schedule

on:
  schedule:
    # 2:30 UTC -> 5:30 AM Amman (Fajr)
    - cron: '30 2 * * *'
    # 5:30 UTC -> 8:30 AM Amman (Morning)
    - cron: '30 5 * * *'
    # 14:30 UTC -> 5:30 PM Amman (Evening)
    - cron: '30 14 * * *'
    # 15:27 UTC -> 6:27 PM Amman (Test Time)
    - cron: '27 15 * * *'
  workflow_dispatch: # Allow manual trigger

jobs:
  ping-endpoints:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Reminder
        run: |
          HOUR=$(date -u +%H)
          echo "Current UTC Hour: $HOUR"
          
          if [ "$HOUR" == "02" ]; then
            echo "üïå Triggering Fajr Reminder..."
            curl -s -X GET "https://cne-athkar-bot.vercel.app/api/cron/fajr"
          elif [ "$HOUR" == "05" ]; then
            echo "üåÖ Triggering Morning Athkar..."
            curl -s -X GET "https://cne-athkar-bot.vercel.app/api/cron/morning"
          elif [ "$HOUR" == "14" ] || [ "$HOUR" == "15" ]; then
            echo "üåô Triggering Evening Athkar..."
            curl -s -X GET "https://cne-athkar-bot.vercel.app/api/cron/evening"
          else
            echo "‚ÑπÔ∏è No specific reminder for hour $HOUR. Running general check..."
            # Optional: curl -s -X GET "https://cne-athkar-bot.vercel.app/api/cron/dispatch"
          fi
